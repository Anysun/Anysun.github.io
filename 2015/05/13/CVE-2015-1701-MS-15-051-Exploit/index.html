<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>CVE-2015-1701 MS15-051 Exploit | Anysun</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Another:Anysun转载请注明出处,谢谢
引用：参考：《Operation RussianDoll: Adobe &amp;amp; Windows Zero-Day Exploits Likely Leveraged by Russia’s APT28 in Highly-Targeted Attack》
描述Win32k Elevation of Privilege Vulnerability">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2015-1701 MS15-051 Exploit">
<meta property="og:url" content="http://www.anysuns.com/2015/05/13/CVE-2015-1701-MS-15-051-Exploit/index.html">
<meta property="og:site_name" content="Anysun">
<meta property="og:description" content="Another:Anysun转载请注明出处,谢谢
引用：参考：《Operation RussianDoll: Adobe &amp;amp; Windows Zero-Day Exploits Likely Leveraged by Russia’s APT28 in Highly-Targeted Attack》
描述Win32k Elevation of Privilege Vulnerability">
<meta property="og:updated_time" content="2015-08-13T06:41:25.237Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CVE-2015-1701 MS15-051 Exploit">
<meta name="twitter:description" content="Another:Anysun转载请注明出处,谢谢
引用：参考：《Operation RussianDoll: Adobe &amp;amp; Windows Zero-Day Exploits Likely Leveraged by Russia’s APT28 in Highly-Targeted Attack》
描述Win32k Elevation of Privilege Vulnerability">
  
    <link rel="alternative" href="/atom.xml" title="Anysun" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/anysun.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Anysun</a></h1>
		</hgroup>

		
		<p class="header-subtitle">No pains No gains</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="/#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/CVE/" style="font-size: 10px;">CVE</a> <a href="/tags/Exploit/" style="font-size: 10px;">Exploit</a> <a href="/tags/Kali/" style="font-size: 10px;">Kali</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/MS15-051/" style="font-size: 10px;">MS15-051</a> <a href="/tags/Pixiewps/" style="font-size: 10px;">Pixiewps</a> <a href="/tags/Reaver/" style="font-size: 10px;">Reaver</a> <a href="/tags/WPS/" style="font-size: 10px;">WPS</a> <a href="/tags/anysun/" style="font-size: 10px;">anysun</a> <a href="/tags/fierce/" style="font-size: 10px;">fierce</a> <a href="/tags/hello/" style="font-size: 10px;">hello</a> <a href="/tags/jekyll/" style="font-size: 10px;">jekyll</a> <a href="/tags/kali/" style="font-size: 16.67px;">kali</a> <a href="/tags/linux/" style="font-size: 20px;">linux</a> <a href="/tags/pixie/" style="font-size: 10px;">pixie</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/ubuntu/" style="font-size: 13.33px;">ubuntu</a> <a href="/tags/wifi/" style="font-size: 10px;">wifi</a> <a href="/tags/拉取/" style="font-size: 10px;">拉取</a> <a href="/tags/爬虫/" style="font-size: 10px;">爬虫</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">奥巴马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">卡卡的美丽传说</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">本泽马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">吉格斯的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">习大大大不同</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">托蒂的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Anysun</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/anysun.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Anysun</h1>
			</hgroup>
			
			<p class="header-subtitle">No pains No gains</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="/#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-CVE-2015-1701-MS-15-051-Exploit" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/05/13/CVE-2015-1701-MS-15-051-Exploit/" class="article-date">
  	<time datetime="2015-05-13T16:40:31.000Z" itemprop="datePublished">2015-05-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      CVE-2015-1701 MS15-051 Exploit
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CVE/">CVE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Exploit/">Exploit</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MS15-051/">MS15-051</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Another:Anysun<br>转载请注明出处,谢谢</p>
<p>引用：<br>参考：<a href="https://www.fireeye.com/blog/threat-research/2015/04/probable_apt28_useo.html" target="_blank" rel="external">《Operation RussianDoll: Adobe &amp; Windows Zero-Day Exploits Likely Leveraged by Russia’s APT28 in Highly-Targeted Attack》</a></p>
<h2 id="描述">描述</h2><p>Win32k Elevation of Privilege Vulnerability</p>
<h2 id="原文">原文</h2><h3 id="CVE-2015-3043_Exploit">CVE-2015-3043 Exploit</h3><p>The payload contains an exploit for the unpatched local privilege escalation vulnerability CVE-2015-1701 in Microsoft Windows. The exploit uses CVE-2015-1701 to execute a callback in userspace. The callback gets the EPROCESS structures of the current process and the System process, and copies data from the System token into the token of the current process. Upon completion, the payload continues execution in usermode with the privileges of the System process.</p>
<p>Because CVE-2015-3043 is already patched, this remote exploit will not succeed on a fully patched system. If an attacker wanted to exploit CVE-2015-1701, they would first have to be executing code on the victim’s machine. Barring authorized access to the victim’s machine, the attacker would have to find some other means, such as crafting a new Flash exploit, to deliver a CVE-2015-1701 payload.</p>
<p>Microsoft is aware of CVE-2015-1701 and is working on a fix. CVE-2015-1701 does not affect Windows 8 and later.<br><a id="more"></a></p>
<h2 id="翻译">翻译</h2><h3 id="CVE-2015-3043_漏洞利用">CVE-2015-3043 漏洞利用</h3><p>在Windows中，这个Payload包含一个本地权限提升漏洞补丁的利用程序 CVE-2015-1701。这个利用程序在用户空间中使用CVE-2015-1701来执行一个CALLBACK(回调)。这个回调获取当前线程和系统线程的EPROCESS结构，并且从系统token(单点)复制数据到当前线程。完成后，这个PayLoad继续执行在带有系统线程权限的用户模式。</p>
<p>由于CVE-2015-3043补丁已经打上，这个远程利用将不会在已经打上补丁的系统执行成功。如果一个攻击者想要利用CVE-2015-1701漏洞,他们首先将不得不在受害者机器上执行代码。（也就是说你要远程搞是没门了，得来个低权限的shell本地run）除非受害者认证通过，攻击者将会不得不寻找一些其他的手段，比如精巧地制作一个新的Flash Exploit,来实现CVE-2015-1701的PayLoad。</p>
<p>微软已经意识到CVE-2015-1701并且正在努力修复。</p>
<p>CVE-2015-1701不影响 Windows 8 And Later.</p>
<h2 id="下载地址">下载地址</h2><a href="/2015/05/13/CVE-2015-1701-MS-15-051-Exploit/CVE-2015-1701.zip" title="源码+编译">源码+编译</a>
<p>Good Luck:)</p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/05/15/python-downlod-picture/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          Python笔记——初学Python拉取图片站爬虫
        
      </div>
    </a>
  
  
    <a href="/2015/05/09/install-fierce-on-ubuntu-14.04/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">从Kali Linux移植Fierce到Ubuntu 14.04</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="CVE-2015-1701-MS-15-051-Exploit" data-title="CVE-2015-1701 MS15-051 Exploit" data-url="http://www.anysuns.com/2015/05/13/CVE-2015-1701-MS-15-051-Exploit/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 Anysun
    	</div>
      	<div class="footer-right">
      		Powered By <a href="http://www.anysuns.com" target="_blank">Anysun</a>  Theme By Litten
      	</div>
    </div>
  </div>
</footer>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>